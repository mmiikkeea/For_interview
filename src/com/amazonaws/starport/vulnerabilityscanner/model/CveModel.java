package com.amazonaws.starport.vulnerabilityscanner.model;

import java.util.List;

import lombok.Value;

@Value
public class CveModel {

    String cveId;
    List<ApplicationModel> appList;
    String summary;
    List<String> os;
    String score;

    public boolean affects(final ApplicationModel imageApp, final String imageOS) {
        boolean flag = false;

        for (final ApplicationModel cveApp : appList) {
            if (cveApp.equals(imageApp)) {
                if (checkOS(imageOS, os)) {
                    flag = true;
                }
            }
        }
        return flag;
    }

    private boolean checkOS(final String imageOs, final List<String> idOS) {
        boolean flag = false;
        if (imageOs == null) {
            flag = true;
        } else if (idOS.isEmpty()) {
            flag = true;
        } else {
            for (final String cveOS : idOS) {
                if (cveOS.contains(imageOs)) {
                    flag = true;
                    break;
                }
            }
        }
        return flag;
    }
}
