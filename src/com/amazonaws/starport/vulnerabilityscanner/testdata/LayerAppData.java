package com.amazonaws.starport.vulnerabilityscanner.testdata;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import com.amazonaws.starport.vulnerabilityscanner.model.ApplicationModel;

public class LayerAppData {
    /*
     * The layer digest:
     * sha256:76582687379951c724499c3f12ea80dd492283a4115aa509474880830e9d14f4
     * The layer digest:
     * sha256:27ec34d038d233ee561e5f4528967823c9bf708e37fde1c4fc90eebf560703ac
     * The layer digest:
     * sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4
     * The layer digest:
     * sha256:580e6785cdfb8e5f9d2048241d8a29752d63a508e11d836330a75320a1d2c780
     * The layer digest:
     * sha256:3b463dce042919034b143e09611cd48d92731ebf0415dd6f8e45671b5559e203
     */

    public List<ApplicationModel> getData(final String layerDigest) {
        final List<ApplicationModel> emptyList = new ArrayList<>();
        if ("sha256:0a19bf9a5daa5b2db390a313c1d5fe31171a5b621443f09e7668eecad7920bb1"
                .equals(layerDigest)) {

            final ApplicationModel app1 = new ApplicationModel("glibc", "7.38");
            final ApplicationModel app2 = new ApplicationModel("bzip2",
                    " 1.0.6");
            final ApplicationModel app3 = new ApplicationModel("pcre", "8.35");
            final ApplicationModel app4 = new ApplicationModel("zlib", "1.2.8");
            final ApplicationModel app5 = new ApplicationModel("systemd",
                    "215-17");
            final ApplicationModel app6 = new ApplicationModel("e2fsprogs",
                    "1.42");

            final List<ApplicationModel> appList1 = new ArrayList<>(
                    Arrays.asList(app1, app2, app3, app4, app5, app6));
            return appList1;

        } else if ("sha256:27ec34d038d233ee561e5f4528967823c9bf708e37fde1c4fc90eebf560703ac"
                .equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("curl", "1.0.0");
            final ApplicationModel app2 = new ApplicationModel("wget", "1.16");

            final ApplicationModel app3 = new ApplicationModel("heimdal", "");

            final List<ApplicationModel> appList2 = new ArrayList<>(
                    Arrays.asList(app1, app2, app3));

            return appList2;

        } else if ("sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4"
                .equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("openssh", "6.7");
            final ApplicationModel app2 = new ApplicationModel("curl", "7.38");
            final List<ApplicationModel> appList1 = new ArrayList<>();
            appList1.add(app1);
            appList1.add(app2);
            return appList1;

        } else if ("sha:433".equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("stunne", "0.1");
            final ApplicationModel app2 = new ApplicationModel("swift", "1.7.5");
            final List<ApplicationModel> appList1 = new ArrayList<>();
            appList1.add(app1);
            appList1.add(app2);
            return appList1;

        } else if ("sha:zzz".equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("java", "7.0");
            final ApplicationModel app2 = new ApplicationModel("udisks",
                    "2.1.1");
            final List<ApplicationModel> appList1 = new ArrayList<>();
            appList1.add(app1);
            appList1.add(app2);
            return appList1;

        } else if ("sha256:3ac8779b67177e7a175c695e64f32242398fc340ed86e0d6edbf1f58649db15c"
                .equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("ruby", "2.31");
            final ApplicationModel app2 = new ApplicationModel("libffi", "");
            final List<ApplicationModel> appList1 = new ArrayList<>();
            appList1.add(app1);
            appList1.add(app2);
            return appList1;

        } else if ("sha:3ac8779b67177e7a175c695e64f32242398fc340ed86e0d6edbf1f58649db15c"
                .equals(layerDigest)) {
            final ApplicationModel app1 = new ApplicationModel("python", "4.7");
            final ApplicationModel app2 = new ApplicationModel("socat", "2.0.0");
            final List<ApplicationModel> appList1 = new ArrayList<>();
            appList1.add(app1);
            appList1.add(app2);
            return appList1;
        }
        return emptyList;
    }

    public String getOS(final String imageDigest) {
        String imageOS = null;
        if ("sha256:43".equals(imageDigest)) {
            imageOS = "debian:2.0";
        } else if ("456".equals(imageDigest)) {
            imageOS = "redhat:5.0";
        } else if ("789".equals(imageDigest))
            imageOS = "ubuntu:14.0";
        return imageOS;
    }
}
